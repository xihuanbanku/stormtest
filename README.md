### 测试storm的整合

* 项目结构

    1. storm_stat 包含了主要的统计逻辑
    2. storm_amap 采用spingboot, 使用高德地图热力图api,用于页面展示统计结果
     

#### storm_stat中的主要逻辑

1. 日志采集使用`logstash`, 监控`/home/hadoop/softs/logstash-2.4.1/logs/access.log`目录下的日志文件, 将结果放入Kafka消息队列中,
`resources/apache-fake-log-gen.py` 脚本用于假日志生成, 执行一次产生50条记录 

2. `storm Spout`使用`KafkaSpout`, 消费`Kafka`中的消息, 格式如下:

```
phone       lan,lng        time
13677777777     116.399466,39.989743    2018-09-26 16:57:24
13788888888     116.38631,39.937209     2018-09-26 16:57:24
13677777777     116.38631,39.937209     2018-09-26 16:57:24
13866666666     116.225404,40.258186    2018-09-26 16:57:24
```

3. 两个bolt, `MyKafkaBolt`用于格式化`KafkaSpout`中的日志格式转换为如下形式

```
lan     lng       time
116.399466    39.989743    2018-09-26 16:57:24
116.38631    39.937209     2018-09-26 16:57:24
116.38631    39.937209     2018-09-26 16:57:24
116.225404    40.258186    2018-09-26 16:57:24
```

4. `JdbcInsertBolt`, 将结果入mysql库


### 总结

* logstash日志收集
* kafka消息队列
* storm 实时计算